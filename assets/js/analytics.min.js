"use strict";var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var e,o=1,r=arguments.length;o<r;o++)for(var n in e=arguments[o])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},__awaiter=this&&this.__awaiter||function(t,u,d,a){return new(d=d||Promise)(function(o,e){function r(t){try{i(a.next(t))}catch(t){e(t)}}function n(t){try{i(a.throw(t))}catch(t){e(t)}}function i(t){var e;t.done?o(t.value):((e=t.value)instanceof d?e:new d(function(t){t(e)})).then(r,n)}i((a=a.apply(t,u||[])).next())})},__generator=this&&this.__generator||function(o,r){var n,i,u,d={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(n)throw new TypeError("Generator is already executing.");for(;d;)try{if(n=1,i&&(u=2&e[0]?i.return:e[0]?i.throw||((u=i.return)&&u.call(i),0):i.next)&&!(u=u.call(i,e[1])).done)return u;switch(i=0,u&&(e=[2&e[0],u.value]),e[0]){case 0:case 1:u=e;break;case 4:return d.label++,{value:e[1],done:!1};case 5:d.label++,i=e[1],e=[0];continue;case 7:e=d.ops.pop(),d.trys.pop();continue;default:if(!(u=0<(u=d.trys).length&&u[u.length-1])&&(6===e[0]||2===e[0])){d=0;continue}if(3===e[0]&&(!u||e[1]>u[0]&&e[1]<u[3])){d.label=e[1];break}if(6===e[0]&&d.label<u[1]){d.label=u[1],u=e;break}if(u&&d.label<u[2]){d.label=u[2],d.ops.push(e);break}u[2]&&d.ops.pop(),d.trys.pop();continue}e=r.call(o,d)}catch(t){e=[6,t],i=0}finally{n=u=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}},page_load="page_load",product_searched="product_searched",product_list_viewed="product_list_viewed",product_list_filtered="product_list_filtered",promotion_viewed="promotion_viewed",promotion_clicked="promotion_clicked",product_clicked="product_clicked",product_viewed="product_viewed",product_added="product_added",product_removed="product_removed",cart_viewed="cart_viewed",checkout_started="checkout_started",checkout_step_viewed="checkout_step_viewed",checkout_step_completed="checkout_step_completed",payment_info_entered="payment_info_entered",order_completed="order_completed",order_updated="order_updated",order_refunded="order_refunded",order_cancelled="order_cancelled",coupon_entered="coupon_entered",coupon_applied="coupon_applied",coupon_denied="coupon_denied",coupon_removed="coupon_removed",product_added_to_wish_list="product_added_to_wish_list",product_removed_from_wish_list="product_removed_from_wish_list",wish_list_product_added_to_cart="wish_list_product_added_to_cart",product_shared="product_shared",cart_shared="cart_shared",product_reviewed="product_reviewed",logged_in="logged_in",signed_up="signed_up",logged_out="logged_out",error="error",Meta=function(){this.session="",this.is_anon=!0,this.user={user_id:"",user_name:"",user_email:"",user_phone:""},this.datetime="",this.page="",this.url="",this.referrer="",this.user_agent="",this.ip_address=""},Campaign=function(){this.utm_source="",this.utm_medium="",this.utm_content="",this.utm_campaign="",this.utm_term=""},Requests=function(){function t(t){this.base_url=document.location.protocol+"//portal.insensedata.com/",this.instance=axios.create({baseURL:this.base_url,timeout:5e3,headers:{"Access-Key":t,"Content-Type":"application/json"}})}return t.prototype.saveData=function(t){return console.log(t),this.instance.post("retail/api/clickstream",t)},t.prototype.getData=function(t){return this.instance.get(t)},t}(),IDTECommerceAnalytics=function(){function t(t){this.user_id="",this.event="",this.request=new Requests(t),this.meta=new Meta,this.campaign=new Campaign,this.sessionalize()}return t.prototype.identify=function(t,e,o,r){var n;return void 0===t&&(t=""),void 0===e&&(e=""),void 0===o&&(o=""),void 0===r&&(r=""),""===t?(this.meta.is_anon=!0,null!==(n=localStorage.getItem("idt_user_id"))&&0!==n.length||(n=this.generateTrackingId(),localStorage.setItem("idt_user_id",n)),this.meta.user.user_id=n):(this.meta.is_anon=!1,this.meta.user.user_id=t,this.meta.user.user_name=e,this.meta.user.user_email=o,this.meta.user.user_phone=r),this},t.prototype.toJson=function(){return{event:this.event,meta:this.meta,campaign:this.campaign,data:this.data}},t.prototype.setCookie=function(t,e,o){void 0===o&&(o={}),(o=__assign({path:"/"},o)).expires instanceof Date&&(o.expires=o.expires.toUTCString());var r=encodeURIComponent(t)+"="+encodeURIComponent(e);for(var n in o){r+="; "+n;var i=o[n];!0!==i&&(r+="="+i)}document.cookie=r},t.prototype.getCookie=function(t){var e=document.cookie.match(new RegExp("(?:^|; )"+t.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return e?decodeURIComponent(e[1]):void 0},t.prototype.randomString=function(t,e){for(var o="",r=t;0<r;--r)o+=e[Math.floor(Math.random()*e.length)];return o},t.prototype.getRefQueryParam=function(t){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var e=new RegExp("[\\?&]"+t+"=([^&#]*)").exec(location.search);return null===e?"":decodeURIComponent(e[1].replace(/\+/g," "))},t.prototype.generateTrackingSessionId=function(){return"IDT-SESSION-"+this.randomString(32,"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ")},t.prototype.generateTrackingId=function(){return this.randomString(8,"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ")+"-"+this.randomString(8,"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ")+"-"+this.randomString(8,"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ")+"-"+this.randomString(8,"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ")},t.prototype.sessionalize=function(){var t=this.getCookie("idt_session");void 0===t?(t=this.generateTrackingSessionId(),this.setCookie("idt_session",t,{"max-age":600}),this.meta.session=this.generateTrackingSessionId()):this.meta.session=t},t.prototype.setCampaign=function(){this.campaign.utm_source=this.getRefQueryParam("utm_source"),this.campaign.utm_medium=this.getRefQueryParam("utm_medium"),this.campaign.utm_content=this.getRefQueryParam("utm_content"),this.campaign.utm_campaign=this.getRefQueryParam("utm_campaign"),this.campaign.utm_term=this.getRefQueryParam("utm_term")},t.prototype.setMeta=function(){var t=new Date,e=t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()+" "+(t.getHours()+":"+t.getMinutes()+":"+t.getSeconds()),o=0==(o=location.pathname.substr(1).split("/")[0]).length?"home":o;this.meta.referrer=document.referrer,this.meta.url=window.location.href,this.meta.page=null!=o?o:"",this.meta.datetime=e,this.meta.user_agent=navigator.userAgent},t.prototype.getIP=function(){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:return e=document.location.protocol,[4,this.request.getData(e+"//api.ipify.org?format=json")];case 1:return[2,t.sent().ip]}})})},t.prototype.execute=function(t,e,o){void 0===o&&(o=""),this.setCampaign(),0<o.length&&(this.meta.page=o),this.event=t,this.data=e;var r=this.toJson();return this.request.saveData(r)},t.prototype.on=function(o,r,n){return void 0===n&&(n=""),__awaiter(this,void 0,void 0,function(){var e=this;return __generator(this,function(t){return this.setMeta(),this.getIP().then(function(t){e.meta.ip_address=t,e.execute(o,r,n)}).catch(function(t){console.log(t),e.execute(o,r,n)}),[2]})})},t.prototype.listen=function(t,e,o){for(var r=document.getElementsByClassName(t),n=0;n<r.length;n++)r[n].addEventListener(e,o)},t.prototype.isInViewPoint=function(t){var e=t.getBoundingClientRect();return 0<=e.top&&0<=e.left&&e.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&e.right<=(window.innerWidth||document.documentElement.clientWidth)},t.prototype.track=function(){var i=this;window.addEventListener("load",function(){var t=0==(t=location.pathname.substr(1).split("/")[0]).length?"home":t;i.on(page_load,{page:t})}),this.listen("idt-search","keyup",function(t,e){i.on(product_searched,{query:t.valueOf()})}),window.addEventListener("scroll",function(t){for(var e=document.getElementsByClassName("idt-products-list"),o=0;o<e.length;o++){var r,n=e[o];i.isInViewPoint(n)&&(r=n.getAttribute("data-idt-payload"),i.on(product_list_viewed,r))}})},t.prototype.onPageLoaded=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,this.on(page_load,{page:e})]})})},t.prototype.onProductSearched=function(o){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){return e={query:o},[2,this.on(product_searched,e)]})})},t.prototype.onProductListViewed=function(o,r){return void 0===r&&(r=[]),__awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){return e={category:o,products:r},[2,this.on(product_list_viewed,e)]})})},t.prototype.onProductListFiltered=function(o,r,n,i){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){return e={category:o,filters:r,sorts:n,products:i},[2,this.on(product_list_filtered,e)]})})},t.prototype.onPromotionViewed=function(o,r,n,i){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){return e={promotion_id:o,creative:n,name:r,position:i},[2,this.on(promotion_viewed,e)]})})},t.prototype.onPromotionClicked=function(o,r,n,i){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){return e={promotion_id:o,creative:n,name:r,position:i},[2,this.on(promotion_clicked,e)]})})},t.prototype.onProductClicked=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,this.on(product_clicked,e)]})})},t.prototype.onProductViewed=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,this.on(product_viewed,e)]})})},t.prototype.onProductAdded=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,this.on(product_added,e)]})})},t.prototype.onProductRemoved=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,this.on(product_removed,e)]})})},t.prototype.onCartViewed=function(o,r){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){return e={cart_id:o,products:r},[2,this.on(cart_viewed,e)]})})},t.prototype.onCheckOutStarted=function(o,r){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){return e={order_id:void 0!==o&&void 0!==o.order_id?o.order_id:"",value:void 0!==o&&void 0!==o.value?o.value:0,revenue:void 0!==o&&void 0!==o.revenue?o.revenue:0,shipping:void 0!==o&&void 0!==o.shipping?o.shipping:0,tax:void 0!==o&&void 0!==o.tax?o.tax:0,discount:void 0!==o&&void 0!==o.discount?o.discount:0,currency:void 0!==o&&void 0!==o.currency?o.currency:"",products:r},[2,this.on(checkout_started,e)]})})},t.prototype.onCheckOutStepViewed=function(o,r,n,i){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){return e={checkout_id:o,step:r,shipping_method:n,payment_method:i},[2,this.on(checkout_step_viewed,e)]})})},t.prototype.onCheckOutStepCompleted=function(o,r,n,i){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){return e={checkout_id:o,step:r,shipping_method:n,payment_method:i},[2,this.on(checkout_step_completed,e)]})})},t.prototype.onPaymentInfoEntered=function(o,r,n,i,u){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){return e={order_id:o,checkout_id:r,step:n,shipping_method:i,payment_method:u},[2,this.on(payment_info_entered,e)]})})},t.prototype.onOrderCompleted=function(o,r){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){return e={checkout_id:void 0!==o&&void 0!==o.checkout_id?o.checkout_id:"",order_id:void 0!==o&&void 0!==o.order_id?o.order_id:"",subtotal:void 0!==o&&void 0!==o.subtotal?o.subtotal:0,total:void 0!==o&&void 0!==o.total?o.total:0,revenue:void 0!==o&&void 0!==o.revenue?o.revenue:0,shipping:void 0!==o&&void 0!==o.shipping?o.shipping:0,tax:void 0!==o&&void 0!==o.tax?o.tax:0,discount:void 0!==o&&void 0!==o.discount?o.discount:0,coupon:void 0!==o&&void 0!==o.coupon?o.coupon:"",currency:void 0!==o&&void 0!==o.currency?o.currency:"",products:r},[2,this.on(order_completed,e)]})})},t.prototype.onOrderUpdated=function(o,r){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){return e={order_id:void 0!==o&&void 0!==o.order_id?o.order_id:"",total:void 0!==o&&void 0!==o.total?o.total:0,revenue:void 0!==o&&void 0!==o.revenue?o.revenue:0,shipping:void 0!==o&&void 0!==o.shipping?o.shipping:0,tax:void 0!==o&&void 0!==o.tax?o.tax:0,discount:void 0!==o&&void 0!==o.discount?o.discount:0,coupon:void 0!==o&&void 0!==o.coupon?o.coupon:"",currency:void 0!==o&&void 0!==o.currency?o.currency:"",products:r},[2,this.on(order_updated,e)]})})},t.prototype.onOrderCancelled=function(o,r){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){return e={order_id:void 0!==o&&void 0!==o.order_id?o.order_id:"",total:void 0!==o&&void 0!==o.total?o.total:0,revenue:void 0!==o&&void 0!==o.revenue?o.revenue:0,shipping:void 0!==o&&void 0!==o.shipping?o.shipping:0,tax:void 0!==o&&void 0!==o.tax?o.tax:0,discount:void 0!==o&&void 0!==o.discount?o.discount:0,coupon:void 0!==o&&void 0!==o.coupon?o.coupon:"",currency:void 0!==o&&void 0!==o.currency?o.currency:"",products:r},[2,this.on(order_cancelled,e)]})})},t.prototype.onOrderRefunded=function(o,r,n,i){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){return e={order_id:o,total:r,currency:n,products:i},[2,this.on(order_refunded,e)]})})},t.prototype.onCouponEntered=function(o,r,n){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){return e={order_id:o,cart_id:r,coupon:n},[2,this.on(coupon_entered,e)]})})},t.prototype.onCouponApplied=function(o,r,n,i){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){return e={order_id:o,cart_id:r,coupon:n,discount:i},[2,this.on(coupon_applied,e)]})})},t.prototype.onCouponRemoved=function(o,r,n,i){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){return e={order_id:o,cart_id:r,coupon:n,discount:i},[2,this.on(coupon_removed,e)]})})},t.prototype.onCouponDenied=function(o,r,n,i){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){return e={order_id:o,cart_id:r,coupon:n,reason:i},[2,this.on(coupon_denied,e)]})})},t.prototype.onProductAddedToWishList=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,this.on(product_added_to_wish_list,e)]})})},t.prototype.onProductRemovedFromWishList=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,this.on(product_removed_from_wish_list,e)]})})},t.prototype.onWishListProductAddedToCart=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,this.on(wish_list_product_added_to_cart,e)]})})},t.prototype.onProductShared=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,this.on(product_shared,e)]})})},t.prototype.onCartShared=function(o,r,n,i,u){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){return e={cart_id:o,share_via:r,share_message:n,recipient:i,products:u},[2,this.on(cart_shared,e)]})})},t.prototype.onProductReviewed=function(o,r,n,i){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){return e={product_id:o,review_id:r,review_body:n,rating:i},[2,this.on(product_reviewed,e)]})})},t.prototype.onLogIn=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,this.on(logged_in,e)]})})},t.prototype.onLogOut=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,this.on(logged_out,{user_id:e})]})})},t.prototype.onSignUp=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,this.on(signed_up,e)]})})},t.prototype.onError=function(o,r,n){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){return e={type:o,message:r,data:n},[2,this.on(error,e)]})})},t.prototype.onEvent=function(t,e){return this.on(t,e)},t}();